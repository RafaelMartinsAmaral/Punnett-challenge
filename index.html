<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Punnett Challenge ‚Äî Normal / Dif√≠cil</title>
<style>
  :root{
    --bg:#ffffff;
    --accent:#0b57d0; /* azul royal */
    --accent-dark:#063fa2;
    --muted:#f3f8ff;
    --danger:#e03b3b;
    --success:#1f9a3a;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--muted),#f8fbff 60%,var(--bg));
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:18px;
    color:#083049;
  }

  .card{
    width:100%;
    max-width:720px;
    background:var(--bg);
    border-radius:14px;
    padding:20px;
    box-shadow: 0 10px 30px rgba(11,87,208,0.06);
    text-align:center;
  }

  h1{margin:6px 0 10px;font-size:26px;color:var(--accent)}
  p.sub{margin:0 0 12px;color:#235;opacity:.9}

  /* buttons */
  .btn{
    background:var(--accent);
    color:#fff;
    border:none;
    padding:12px 18px;
    border-radius:10px;
    font-weight:700;
    font-size:15px;
    cursor:pointer;
    box-shadow:0 8px 22px rgba(11,87,208,0.08);
    transition: transform .12s ease, box-shadow .12s ease, background .12s;
    display:inline-flex;
    align-items:center;
    gap:8px;
  }
  .btn:active{ transform: scale(.98) }
  .btn.secondary{
    background:#fff;
    color:var(--accent);
    border:1px solid rgba(11,87,208,0.08);
    box-shadow:none;
  }

  .small{font-size:13px;color:#234;opacity:.9}

  /* HUD */
  .hud{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
  .hud-left{ text-align:left; }
  .hud-right{ text-align:right; min-width:160px; }

  #phaseTitle{font-size:18px;color:var(--accent-dark); margin: 4px 0;}
  #phaseSub{font-size:13px;color:#456}

  /* lives above timer (requested A) */
  .lives-row{ display:flex; justify-content:center; gap:8px; margin-bottom:6px; font-size:20px; }
  #timer{ font-weight:700; color:var(--danger); margin-bottom:6px; }

  #message{ min-height:28px; font-weight:700; margin-bottom:6px; }

  /* grid dynamic (2x2 or 4x4) */
  #punnettGrid{
    display:grid;
    gap:12px;
    margin:14px auto 6px;
    max-width:680px;
  }
  .cell{
    background: #fff;
    border: 2px solid rgba(11,87,208,0.10);
    border-radius:12px;
    padding:18px 10px;
    font-size:20px;
    cursor:pointer;
    user-select:none;
    transition: transform .12s ease, background .12s ease, box-shadow .12s;
    box-shadow: 0 8px 20px rgba(11,87,208,0.04);
    display:flex;
    align-items:center;
    justify-content:center;
    min-width:72px;
    min-height:64px;
  }
  .cell:hover{ transform: translateY(-6px); background: #eef6ff; }
  .cell.pop{ animation: pop .22s cubic-bezier(.2,.8,.2,1); }
  @keyframes pop{ 0%{transform:scale(1)} 50%{transform:scale(1.07)} 100%{transform:scale(1)} }

  /* final / ranking */
  #rankingList{ text-align:left; margin-top:12px; max-height:220px; overflow:auto; padding:6px; border-radius:8px; border:1px solid rgba(11,87,208,0.04) }

  input[type="text"]{ padding:10px; border-radius:8px; border:1px solid rgba(11,87,208,0.12); width:100%; max-width:320px; }

  /* responsive tweaks */
  @media (max-width:820px){
    .hud-right{ min-width:120px; }
    #punnettGrid{ max-width:420px; }
  }
  @media (max-width:420px){
    .card{ padding:14px }
    .cell{ padding:12px; font-size:16px; min-height:56px }
  }
.medal {
  font-size: 1.25rem;
  line-height: 1;
  display: inline-block;
  width: 36px;
  text-align: center;
}
.rank-num {
  color: rgba(3,40,80,0.45);
  font-weight:700;
  width:36px;
  text-align:center;
}
</style>
</head>
<body>
  <div class="card" role="application" aria-label="Punnett Challenge">

    <!-- MENU: mode selection -->
    <div id="menuView">
      <h1>Punnett Challenge</h1>
      <p class="sub">Escolha o modo e encontre o erro no quadro. 10s por fase. Erro = perde 1 vida (3 vidas).</p>

      <div style="display:flex;gap:12px;justify-content:center;margin:14px 0">
        <button id="startNormal" class="btn">Come√ßar (Normal)</button>
        <button id="startHard" class="btn secondary">Come√ßar (Dif√≠cil)</button>
      </div>

      <div style="display:flex;gap:10px;justify-content:center">
        <button id="howBtn" class="btn secondary">Como jogar</button>
      </div>
    </div>

    <!-- GAME -->
    <div id="gameView" style="display:none">
      <div class="hud">
        <div class="hud-left">
          <div id="phaseTitle">Fase</div>
          <div id="phaseSub" class="small">Cruzamento: ‚Äî</div>
        </div>
        <div class="hud-right">
          <div class="lives-row" id="livesRow" aria-live="polite"></div>
          <div id="timer">‚è≥ 10s</div>
        </div>
      </div>

      <div id="message" aria-live="polite"></div>

      <div id="punnettGrid" aria-hidden="false"></div>

      <div style="margin-top:12px;display:flex;gap:8px;justify-content:center">
        <button id="quitBtn" class="btn secondary">Sair</button>
      </div>
    </div>

    <!-- END -->
    <div id="endView" style="display:none">
      <h1>üèÅ Final</h1>
      <p id="finalMsg" class="small"></p>

      <div id="nameInputArea" style="display:none;margin-top:12px;">
        <label class="small">Seu nome:</label><br>
        <input id="playerName" type="text" placeholder="Seu nome" />
        <div style="margin-top:8px;display:flex;gap:8px;justify-content:center">
          <button id="saveBtn" class="btn">Salvar</button>
          <button id="retryBtn" class="btn secondary">Jogar Novamente</button>
        </div>
      </div>

      <!-- Jogar novamente sempre vis√≠vel -->
      <div style="margin-top:12px; display:flex; justify-content:center;">
        <button id="retryBtnAlways" class="btn">Jogar Novamente</button>
      </div>

      <div id="rankingBox" style="margin-top:14px">
        <h3 class="small" style="color:var(--accent)">Ranking (melhores tempos)</h3>
        <div id="rankingList" class="small"></div>
      </div>
    </div>

  </div>

  <!-- background music (will start on user click) -->
  <audio id="bgm" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/09/audio_4cecd8e1b0.mp3?filename=cute-background-music-118192.mp3" type="audio/mpeg">
  </audio>

<script>
/* -------------------------
   Full upgraded game:
   - Mode selection (normal / hard)
   - Normal: 2x2 grids (8 phases)
   - Hard: 4x4 grids (dihybrid) (8 phases)
   - Lives (3) shown above timer
   - Timer 10s, sounds, bgm, ranking
   - Save only for playerWon (completed all phases)
   - "Jogar Novamente" always visible at end
   -------------------------*/

/* Short beep helper (WebAudio) */
function beep(freq=440, duration=180, volume=0.07){
  try{
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.connect(g); g.connect(ctx.destination);
    o.type = 'sine';
    o.frequency.value = freq;
    g.gain.value = volume;
    o.start();
    g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + duration/1000);
    setTimeout(()=>{ try{ o.stop(); ctx.close(); }catch(e){} }, duration+30);
  }catch(e){}
}

/* ======== PHASES DATA ========
   We'll keep 8 phases per mode.
   For hard mode we use 4x4 arrays (length 16).
   In each phase we store:
     - title, cross (string for subtitle)
     - correct: array (length 4 or 16)
     - error: array (same length) with one or more wrong entries
   Note: the checking logic remains p.error[i] !== p.correct[i]
*/

/* Normal mode phases (2x2) - kept from your approved set */
const normalPhases = [
  { title: "Fase 1 ‚Äì Aa √ó Aa", cross: "Aa √ó Aa", correct: ["AA","Aa","Aa","aa"], error: ["AA","Aa","Aa","AA"] },
  { title: "Fase 2 ‚Äì AA √ó Aa", cross: "AA √ó Aa", correct: ["AA","AA","Aa","Aa"], error: ["AA","Aa","Aa","Aa"] },
  { title: "Fase 3 ‚Äì aa √ó Aa", cross: "aa √ó Aa", correct: ["Aa","Aa","aa","aa"], error: ["Aa","Aa","Aa","aa"] },
  { title: "Fase 4 ‚Äì AA √ó aa", cross: "AA √ó aa", correct: ["Aa","Aa","Aa","Aa"], error: ["Aa","Aa","aa","Aa"] },
  { title: "Fase 5 ‚Äì Aa √ó aa", cross: "Aa √ó aa", correct: ["Aa","aa","Aa","aa"], error: ["aa","aa","Aa","aa"] },
  { title: "Fase 6 ‚Äì AA √ó AA", cross: "AA √ó AA", correct: ["AA","AA","AA","AA"], error: ["AA","AA","AA","Aa"] },
  { title: "Fase 7 ‚Äì aa √ó aa", cross: "aa √ó aa", correct: ["aa","aa","aa","aa"], error: ["aa","aa","Aa","aa"] },
  { title: "Fase 8 ‚Äì Aa √ó AA", cross: "Aa √ó AA", correct: ["AA","Aa","AA","Aa"], error: ["AA","AA","AA","Aa"] },
];

/* Hard mode phases (4x4) ‚Äî dihybrid crosses (AaBb √ó AaBb, etc.)
   Each phase here uses correct: 16-element array and error: 16-element with at least one wrong cell
   NOTE: arrays are in row-major order (0..15). We'll lay out as 4 cols.
*/
const hardPhases = [
  {
    title: "Dif√≠cil 1 ‚Äì AaBb √ó AaBb",
    cross: "AaBb √ó AaBb",
    correct: [
      "AABB","AABb","AaBB","AaBb",
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ],
    error: [
      "AaBB","AABb","AaBB","AaBb",   // <- erro no √≠ndice 0
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ]
  },

  {
    title: "Dif√≠cil 2 ‚Äì AABb √ó AaBb",
    cross: "AABb √ó AaBb",
    correct: [
      "AABB","AABb","AaBB","AaBb",
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ],
    error: [
      "AABB","AABb","AaBB","AAbb",  // <- erro no √≠ndice 3
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ]
  },

  {
    title: "Dif√≠cil 3 ‚Äì AaBb √ó AAbb",
    cross: "AaBb √ó AAbb",
    correct: [
      "AaBb","Aabb","AaBb","Aabb",
      "Aabb","aabb","Aabb","aabb",
      "AaBb","Aabb","AaBb","Aabb",
      "aabb","aabb","aabb","aabb"
    ],
    error: [
      "AaBb","Aabb","AaBb","Aabb",
      "Aabb","AAbb","Aabb","aabb",  // <- erro no √≠ndice 5
      "AaBb","Aabb","AaBb","Aabb",
      "aabb","aabb","aabb","aabb"
    ]
  },

  {
    title: "Dif√≠cil 4 ‚Äì AaBB √ó aaBb",
    cross: "AaBB √ó aaBb",
    correct: [
      "AaBB","AaBb","AaBB","AaBb",
      "aaBB","aaBb","aaBB","aaBb",
      "AaBB","AaBb","AaBB","AaBb",
      "aaBB","aaBb","aaBB","aaBb"
    ],
    error: [
      "AaBB","AaBb","AaBB","AaBb",
      "aaBB","aaBb","aaBB","aaBB",  // <- erro no √≠ndice 7
      "AaBB","AaBb","AaBB","AaBb",
      "aaBB","aaBb","aaBB","aaBb"
    ]
  },

  {
    title: "Dif√≠cil 5 ‚Äì AaBb √ó aaBB",
    cross: "AaBb √ó aaBB",
    correct: [
      "AaBB","AaBb","aaBB","aaBb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBB","AaBb","aaBB","aaBb"
    ],
    error: [
      "AaBB","AaBb","aaBB","aaBb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBB","AaBb","AaBB","aaBb",  // <- erro no √≠ndice 9
      "AaBB","AaBb","aaBB","aaBb"
    ]
  },

  {
    title: "Dif√≠cil 6 ‚Äì AAbb √ó AaBb",
    cross: "AAbb √ó AaBb",
    correct: [
      "AaBb","Aabb","AaBb","Aabb",
      "Aabb","aabb","Aabb","aabb",
      "AaBb","Aabb","AaBb","Aabb",
      "AaBb","Aabb","AaBb","Aabb"
    ],
    error: [
      "AaBb","Aabb","AaBb","Aabb",
      "Aabb","aabb","Aabb","aabb",
      "aabb","Aabb","AaBb","Aabb",  // <- erro no √≠ndice 12
      "AaBb","Aabb","AaBb","Aabb"
    ]
  },

  {
    title: "Dif√≠cil 7 ‚Äì AaBb √ó AABb",
    cross: "AaBb √ó AABb",
    correct: [
      "AABB","AABb","AaBB","AaBb",
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ],
    error: [
      "AABB","AABb","AaBB","AaBb",
      "AABb","AAbb","AaBb","Aabb",
      "AaBB","AaBb","aaBB","AaBB",  // <- erro no √≠ndice 14
      "AaBb","Aabb","aaBb","aabb"
    ]
  },

  {
    title: "Dif√≠cil 8 ‚Äì AaBb √ó aaBb",
    cross: "AaBb √ó aaBb",
    correct: [
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb"
    ],
    error: [
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","aabb",
      "AaBB","AaBb","aaBB","aaBb",
      "AaBb","Aabb","aaBb","AaBb"   // <- erro no √≠ndice 15
    ]
  }
];

/* state */
let mode = 'normal'; // 'normal' or 'hard'
let phases = normalPhases; // pointer to current mode phases
let idx = 0;
let timeLeft = 10;
let timerInterval = null;
let lives = 3;
let totalStart = 0;
let totalEnd = 0;
let playerWon = false;

/* elements */
const menuView = document.getElementById('menuView');
const gameView = document.getElementById('gameView');
const endView = document.getElementById('endView');

const phaseTitle = document.getElementById('phaseTitle');
const phaseSub = document.getElementById('phaseSub');
const livesRow = document.getElementById('livesRow');
const timerEl = document.getElementById('timer');
const messageEl = document.getElementById('message');
const gridEl = document.getElementById('punnettGrid');

const startNormal = document.getElementById('startNormal');
const startHard = document.getElementById('startHard');
const howBtn = document.getElementById('howBtn');
const quitBtn = document.getElementById('quitBtn');
const retryBtn = document.getElementById('retryBtn');
const retryBtnAlways = document.getElementById('retryBtnAlways');
const saveBtn = document.getElementById('saveBtn');
const playerNameInput = document.getElementById('playerName');
const finalMsg = document.getElementById('finalMsg');
const nameInputArea = document.getElementById('nameInputArea');
const rankingList = document.getElementById('rankingList');
const bgm = document.getElementById('bgm');

startNormal.onclick = ()=> startWithMode('normal');
startHard.onclick = ()=> startWithMode('hard');
howBtn.onclick = ()=> alert("Encontre a c√©lula ERRADA no Quadro de Punnett. 10s por fase. Erro = perde 1 vida (3 vidas). Complete todas as fases para poder salvar seu nome no ranking.");
quitBtn.onclick = ()=> location.reload();
retryBtn.onclick = ()=> location.reload();
retryBtnAlways.onclick = ()=> location.reload();
saveBtn.onclick = ()=> saveScore();

/* render hearts (red emoji hearts) */
function renderLives(){
  livesRow.innerHTML = '';
  for(let i=0;i<lives;i++){
    const s = document.createElement('div');
    s.textContent = '‚ù§Ô∏è';
    s.style.fontSize = '20px';
    s.setAttribute('aria-hidden','true');
    livesRow.appendChild(s);
  }
  if(lives === 0){
    livesRow.textContent = 'üíÄ';
  }
}

// Fun√ß√£o para embaralhar fases (Fisher‚ÄìYates)
function shuffle(array){
  const arr = array.slice(); // copia
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* start game with chosen mode */
function startWithMode(chosen){
  mode = chosen;

  // embaralhar fases dos dois modos
  if(mode === 'normal'){
    phases = shuffle(normalPhases);
  } else {
    phases = shuffle(hardPhases);
  }

  idx = 0;
  lives = 3;
  playerWon = false;
  totalStart = Date.now();
  menuView.style.display = 'none';
  endView.style.display = 'none';
  gameView.style.display = 'block';
  messageEl.textContent = '';
  renderLives();
  loadPhase();
  startTimer();

  try{
    bgm.currentTime = 0;
    bgm.volume = 0.35;
    bgm.play().catch(()=>{});
  }catch(e){}
}

/* load a phase: render grid according to phase length (2x2 or 4x4) */
function loadPhase(){
  const p = phases[idx];
  phaseTitle.textContent = p.title;
  phaseSub.textContent = 'Cruzamento: ' + (p.cross || '‚Äî');
  messageEl.textContent = '';
  gridEl.innerHTML = '';

  const len = p.error.length;
  if(len === 4){
    gridEl.style.gridTemplateColumns = 'repeat(2,1fr)';
    // set cell size via CSS min-width remains
  } else if(len === 16){
    gridEl.style.gridTemplateColumns = 'repeat(4,1fr)';
  } else {
    // fallback: arrange as square
    const cols = Math.ceil(Math.sqrt(len));
    gridEl.style.gridTemplateColumns = `repeat(${cols},1fr)`;
  }

  p.error.forEach((g,i)=>{
    const div = document.createElement('div');
    div.className = 'cell';
    div.textContent = g;
    div.onclick = ()=> onCellClick(i,div);
    gridEl.appendChild(div);
  });
}

/* timer */
function startTimer(){
  clearInterval(timerInterval);
  timeLeft = (mode === 'hard') ? 30 : 10;

  timerEl.textContent = '‚è≥ ' + timeLeft + 's';

  timerInterval = setInterval(()=>{
    timeLeft--;
    timerEl.textContent = '‚è≥ ' + timeLeft + 's';
    if(timeLeft <= 0){
      clearInterval(timerInterval);
      onFail('‚õî Tempo esgotado!');
    }
  },1000);
}

/* cell click */
function onCellClick(i, el){
  el.classList.add('pop');
  const p = phases[idx];
  const isError = p.error[i] !== p.correct[i];
  if(isError){
    onSuccess();
  } else {
    // wrong
    lives--;
    renderLives();
    messageEl.style.color = 'var(--danger)';
    messageEl.textContent = '‚ùå Esse n√£o √© o erro!';
    beep(220, 160, 0.07);
    if(lives <= 0){
      setTimeout(()=> onFail('üíÄ Sem vidas restantes!'), 300);
      return;
    }
  }
}

/* success */
function onSuccess(){
  clearInterval(timerInterval);
  beep(640,200,0.08);
  messageEl.style.color = 'var(--success)';
  messageEl.textContent = '‚úî Acertou!';
  idx++;
  if(idx >= phases.length){
    totalEnd = Date.now();
    playerWon = true;
    setTimeout(()=> onEnd('üéâ Voc√™ completou todas as fases!'), 700);
    return;
  }
  setTimeout(()=>{ messageEl.textContent = ''; loadPhase(); startTimer(); }, 700);
}

/* fail */
function onFail(msg){
  totalEnd = Date.now();
  playerWon = false;
  onEnd(msg);
}

/* show end screen */
function onEnd(msg){
  clearInterval(timerInterval);
  gameView.style.display = 'none';
  endView.style.display = 'block';
  finalMsg.textContent = msg + ' Tempo: ' + getTotalTime().toFixed(1) + 's';
  // show name input only if playerWon
  nameInputArea.style.display = playerWon ? 'block' : 'none';
  renderRanking();
  try{ bgm.pause(); bgm.currentTime = 0; }catch(e){}
}

/* total time */
function getTotalTime(){
  const s = totalStart || Date.now();
  const e = totalEnd || Date.now();
  return (e - s)/1000;
}

function getRankingKey() {
  return (mode === 'hard')
    ? 'punnett_ranking_hard'
    : 'punnett_ranking_normal';
}

function saveScore() {
if (!playerWon) return;
const name = (playerNameInput.value || "Anon").trim().slice(0, 20);
const time = getTotalTime();

saveOnlineScore(mode, name, time);

saveBtn.textContent = "Salvo ‚úì";
setTimeout(() => saveBtn.textContent = "Salvar", 1200);
saveBtn.style.display = "none";

renderRanking();
  }
/* render ranking (Firebase) */
function renderRanking() {
  loadOnlineRanking(mode, (list) => {
    if (!list.length) {
      rankingList.innerHTML = "<div class='small'>Nenhum score salvo ainda.</div>";
      return;
    }

    // medalhas
    const medals = ["ü•á", "ü•à", "ü•â"];

    let html = "";
    list
      .sort((a, b) => a.time - b.time)
      .slice(0, 10)
      .forEach((s, i) => {

        const medal = (i < 3) 
          ? `<span style="font-size:1.3rem">${medals[i]}</span>`
          : `<span style="opacity:0.5;font-weight:600">${i+1}.</span>`;

        const displayName = s.name || s.key || "Anon";

        html += `
        <div style="display:flex;justify-content:space-between;align-items:center;
          padding:8px 0;border-bottom:1px dashed rgba(11,87,208,0.04)">

          <div style="display:flex;align-items:center;gap:8px;">
            ${medal}
            <span>${escapeHtml(displayName)}</span>
          </div>

          <div>${s.time.toFixed(1)}s</div>
        </div>`;
      });

    rankingList.innerHTML = html;
  });
                                       }

/* tiny helper */
function escapeHtml(str){ return String(str).replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

/* init */
(function init(){
  menuView.style.display = 'block';
  gameView.style.display = 'none';
  endView.style.display = 'none';
})();
</script>
<!-- Firebase SDK compat (para HTML puro) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // ---- CONFIG DO SEU PROJETO ----
  const firebaseConfig = {
    apiKey: "AIzaSyAIqcffoEYkHNzkPbCJKL_wyKoKEZ2o4TY",
    authDomain: "punnnet-challenge.firebaseapp.com",
    databaseURL: "https://punnnet-challenge-default-rtdb.firebaseio.com",
    projectId: "punnnet-challenge",
    storageBucket: "punnnet-challenge.firebasestorage.app",
    messagingSenderId: "476402325418",
    appId: "1:476402325418:web:2fb6f04441195d76893dd3",
    measurementId: "G-160BZTNGDT"
  };

  // Inicializa o Firebase usando vers√£o compat
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  /* ========= FUN√á√ïES DE RANKING GLOBAL ========= */

  // Salvar score no ranking
  function saveOnlineScore(mode, name, time) {
    db.ref("ranking/" + mode).push({
      name: name,
      time: time,
      timestamp: Date.now()
    });
  }

  // Ler ranking global
function loadOnlineRanking(mode, callback) {
  db.ref("ranking/" + mode)
    .orderByChild("time")
    .limitToFirst(10)
    .once("value", (snapshot) => {
      const list = [];

      snapshot.forEach((child) => {
        const data = child.val();
        data.key = child.key; // <-- garante nome caso s.name esteja undefined
        list.push(data);
      });

      callback(list);
    });
}
</script>
</body>
</html>
